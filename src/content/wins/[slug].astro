---
import Layout from "../../layouts/Layout.astro";
import SEO from "../../components/SEO.astro";
import { getCollection } from "astro:content";

const { slug } = Astro.params;
const entries = await getCollection("wins");
const entry = entries.find(e => e.slug === slug);  // <-- use e.slug (auto)
if (!entry) throw new Error(`Win not found: ${slug}`);

const { Content } = await entry.render();
const title = `${entry.data.title} — Systems Win`;
const description = entry.data.summary || "Systems Win case study";
---
<Layout title={title} description={description} currentPath={`/systems-wins/${slug}`}>
  <SEO title={title} description={description} />
  <article class="prose prose-invert max-w-none">
    <h1 class="mb-2">{entry.data.title}</h1>
    <p class="text-sm text-zinc-400">
      {new Date(entry.data.date).toLocaleDateString("en-GB")} · {entry.data.tags?.join(" · ")}
    </p>
    <div class="mt-6">
      <Content />
    </div>
  </article>
</Layout>
