---
import Layout from "../../layouts/BaseLayout.astro";
import SEO from "../../components/SEO.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("wins");
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const title = `${entry.data.title} — Systems Win`;
const description = entry.data.summary ?? "Systems Win case study";
const currentPath = `/system-wins/${entry.slug}`;
---
<Layout title={title} description={description} currentPath={currentPath}>
  <SEO title={title} description={description} />
  <article class="prose prose-invert max-w-none">
    <h1 class="mb-2">{entry.data.title}</h1>
    <p class="text-sm text-zinc-400">
      {new Date(entry.data.date).toLocaleDateString("en-GB")} · {entry.data.tags?.join(" · ")}
    </p>
    <div class="mt-6">
      <Content />
    </div>
  </article>
</Layout>
